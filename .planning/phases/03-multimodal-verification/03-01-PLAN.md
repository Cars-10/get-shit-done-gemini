---
phase: 03-multimodal-verification
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [GSD-STYLE.md, agents/gsd-executor.md, agents/gsd-verifier.md]
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Plan execution can pause for a visual checkpoint"
    - "User is prompted to take a screenshot and save it to a specific path"
    - "Verifier agent can accept an image path as input context"
  artifacts:
    - path: "agents/gsd-executor.md"
      provides: "Executor logic for checkpoint:visual-verify"
      contains: "checkpoint:visual-verify"
    - path: "agents/gsd-verifier.md"
      provides: "Multimodal verification logic"
      contains: "multimodal"
  key_links:
    - from: "gsd-executor"
      to: "gsd-verifier"
      via: "checkpoint handoff"
---

<objective>
Enable the "Visual Checkpoint" protocol in the GSD Executor and Verifier agents.

Purpose: Allow Gemini to "see" the work it has done by requesting screenshots from the user and analyzing them against requirements.
Output: Updated agent prompts supporting `checkpoint:visual-verify`.
</objective>

<execution_context>
@~/.gemini/get-shit-done/workflows/execute-plan.md
@~/.gemini/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-multimodal-verification/03-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Define Visual Checkpoint Protocol</name>
  <files>GSD-STYLE.md</files>
  <action>
    Update GSD-STYLE.md to include the `checkpoint:visual-verify` task type definition.
    - Define XML structure: `<task type="checkpoint:visual-verify">`
    - Define expected Executor behavior: Pause, request screenshot, wait for user signal.
    - Define file convention: `tests/visual/{phase}-{plan}-{slug}.png`
  </action>
  <verify>grep "checkpoint:visual-verify" GSD-STYLE.md</verify>
  <done>Style guide documents the new task type and screenshot conventions.</done>
</task>

<task type="auto">
  <name>Task 2: Update Executor Agent for Visual Checkpoints</name>
  <files>agents/gsd-executor.md</files>
  <action>
    Update `agents/gsd-executor.md` to handle `type="checkpoint:visual-verify"`.
    - Add to `<checkpoint_protocol>` section.
    - Define specific return format:
      - **Type:** `checkpoint:visual-verify`
      - **Action Required:** "Take screenshot of [target] and save to [path]"
    - Ensure it instructs the user exactly where to save the file based on the plan/task context.
  </action>
  <verify>grep "checkpoint:visual-verify" agents/gsd-executor.md</verify>
  <done>Executor agent prompt includes specific instructions for handling visual verification checkpoints.</done>
</task>

<task type="auto">
  <name>Task 3: Update Verifier Agent for Multimodal Analysis</name>
  <files>agents/gsd-verifier.md</files>
  <action>
    Update `agents/gsd-verifier.md` to support multimodal inputs.
    - Add instruction to look for image files in `tests/visual/` if referenced.
    - Add logic for "Semantic Visual Verification":
      - IF image provided: Compare image content against text requirements.
      - IF golden image provided: Compare screenshot against golden reference.
    - Add `<multimodal_capabilities>` section describing how to critique UI (padding, colors, alignment) vs text requirements.
  </action>
  <verify>grep "multimodal_capabilities" agents/gsd-verifier.md</verify>
  <done>Verifier agent is equipped to analyze images when they are provided in the context.</done>
</task>

</tasks>

<verification>
Check that the agent definitions now support the full loop: Executor pauses -> User acts -> Verifier analyzes.
</verification>

<success_criteria>
- [ ] GSD-STYLE.md defines the visual checkpoint standard.
- [ ] gsd-executor.md knows how to pause for screenshots.
- [ ] gsd-verifier.md knows how to analyze those screenshots.
</success_criteria>

<output>
After completion, create `.planning/phases/03-multimodal-verification/03-01-SUMMARY.md`
</output>
