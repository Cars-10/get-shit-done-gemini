description = "Execute a PLAN.md file"
prompt = "<objective>\nExecute a single PLAN.md file by spawning a subagent.\n\nOrchestrator stays lean: validate plan, spawn subagent, handle checkpoints, report completion. Subagent loads full execute-plan workflow and handles all execution details.\n\nContext budget: ~15% orchestrator, 100% fresh for subagent.\n</objective>\n\n<execution_context>\n@./.gemini/get-shit-done/templates/subagent-task-prompt.md\n</execution_context>\n\n<context>\nPlan path: $ARGUMENTS\n\n@.planning/STATE.md\n@.planning/config.json (if exists)\n</context>\n\n<process>\n1. **Validate plan exists**\n   - Confirm file at $ARGUMENTS exists\n   - Error if not found: \"Plan not found: {path}\"\n\n2. **Check if already executed**\n   - Derive SUMMARY path from plan path (replace PLAN.md with SUMMARY.md)\n   - If SUMMARY exists: \"Plan already executed. SUMMARY: {path}\"\n   - Offer: re-execute or exit\n\n3. **Parse plan identifiers**\n   Extract from path like `.planning/phases/03-auth/03-02-PLAN.md`:\n   - phase_number: `03`\n   - phase_name: `auth`\n   - plan_number: `02`\n   - plan_path: full path\n\n4. **Fill and spawn subagent**\n   - Fill subagent-task-prompt template with extracted values\n   - Spawn: `Task(prompt=filled_template, subagent_type=\"general-purpose\")`\n\n5. **Handle subagent return**\n   - If contains \"## CHECKPOINT REACHED\": Execute checkpoint_handling\n   - If contains \"## PLAN COMPLETE\": Verify SUMMARY exists, report success\n\n6. **Report completion**\n   - Show SUMMARY path\n   - Show commits from subagent return\n   - Offer next steps\n</process>\n\n<checkpoint_handling>\nWhen subagent returns with checkpoint:\n\n**1. Parse return:**\n```\n## CHECKPOINT REACHED\n\n**Type:** [human-verify | decision | human-action]\n**Plan:** {phase}-{plan}\n**Progress:** {completed}/{total} tasks complete\n\n[Checkpoint content]\n\n**Awaiting:** [Resume signal]\n```\n\n**2. Present to user:**\nDisplay the checkpoint content exactly as returned by subagent.\n\n**3. Collect response:**\nWait for user input:\n- human-verify: \"approved\" or description of issues\n- decision: option selection\n- human-action: \"done\" when complete\n\n**4. Resume subagent:**\n```\nTask(resume=\"{agent_id}\", prompt=\"User response: {user_input}\")\n```\n\n**5. Repeat:**\nContinue handling returns until \"## PLAN COMPLETE\" or user stops.\n</checkpoint_handling>\n\n<success_criteria>\n- [ ] Plan executed (SUMMARY.md created)\n- [ ] All checkpoints handled\n- [ ] User informed of completion and next steps\n</success_criteria>"
